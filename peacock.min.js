// Peacock.js 1.0.0

!function(){for(var e=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],t="http://www.w3.org/1999/xlink",r="http://www.w3.org/XML/1998/namespace",n=58,i=120,o=Object.create(null),a=0,d=e.length;a<d;a++)o[e[a]]=!0;function l(e,a){var d=a.elm,l=e.data.attrs,s=a.data.attrs;if((l||s)&&l!==s){for(u in l=l||{},s=s||{})if(u&&void 0!==u){var u,f=s[u=u.replace(/[|&;$%@"<>()+,]/g,"")];l[u]!==f&&(o[u]?f?d.setAttribute(u,""):d.removeAttribute(u):u.charCodeAt(0)!==i?d.setAttribute(u,f):u.charCodeAt(3)===n?d.setAttributeNS(r,u,f):u.charCodeAt(5)===n?d.setAttributeNS(t,u,f):d.setAttribute(u,f))}for(u in l)u in s||d.removeAttribute(u)}}var s={create:l,update:l};function u(e,t){var r,n,i=t.elm,o=e.data.class,a=t.data.class;if((o||a)&&o!==a){for(n in a=a||{},o=o||{})a[n]||i.classList.remove(n);for(n in a)(r=a[n])!==o[n]&&i.classList[r?"add":"remove"](n)}}var f={create:u,update:u},c=/[A-Z]/g;function v(e,t){var r,n=t.elm,i=e.data.dataset,o=t.data.dataset;if((i||o)&&i!==o){i=i||{},o=o||{};var a=n.dataset;for(r in i)o[r]||(a?r in a&&delete a[r]:n.removeAttribute("data-"+r.replace(c,"-$&").toLowerCase()));for(r in o)i[r]!==o[r]&&(a?a[r]=o[r]:n.setAttribute("data-"+r.replace(c,"-$&").toLowerCase(),o[r]))}}var h={create:v,update:v};function m(e,t){var r,n,i=t.elm,o=e.data.props,a=t.data.props;if((o||a)&&o!==a){for(r in a=a||{},o=o||{})a[r]||delete i[r];for(r in a)n=a[r],o[r]===n||"value"===r&&i[r]===n||(i[r]=n)}}var p={create:m,update:m},y="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,g=function(e){y(function(){y(e)})};function b(e,t,r){g(function(){e[t]=r})}function w(e,t){var r,n,i=t.elm,o=e.data.style,a=t.data.style;if((o||a)&&o!==a){a=a||{};var d="delayed"in(o=o||{});for(n in o)a[n]||("-"===n[0]&&"-"===n[1]?i.style.removeProperty(n):i.style[n]="");for(n in a)if(r=a[n],"delayed"===n&&a.delayed)for(var l in a.delayed)r=a.delayed[l],d&&r===o.delayed[l]||b(i.style,l,r);else"remove"!==n&&r!==o[n]&&("-"===n[0]&&"-"===n[1]?i.style.setProperty(n,r):i.style[n]=r)}}var x={create:w,update:w,destroy:function(e){var t,r,n=e.elm,i=e.data.style;if(i&&(t=i.destroy))for(r in t)n.style[r]=t[r]},remove:function(e,t){var r=e.data.style;if(r&&r.remove){var n,i=e.elm,o=0,a=r.remove,d=0,l=[];for(n in a)l.push(n),i.style[n]=a[n];for(var s=getComputedStyle(i)["transition-property"].split(", ");o<s.length;++o)-1!==l.indexOf(s[o])&&d++;i.addEventListener("transitionend",function(e){e.target===i&&--d,0===d&&t()})}else t()}};function k(e,t,r,n,i){return{sel:e,data:t,children:r,text:n,elm:i,key:void 0===t?void 0:t.key}}var A={};function C(e){return document.createTextNode(e)}function N(e,t,r){e.insertBefore(t,r)}function L(e,t){e.removeChild(t)}function T(e,t){e.appendChild(t)}function M(e){return e.parentNode}function E(e){return e.nextSibling}function O(e){return e.tagName}function B(e,t){e.textContent=t}function D(e){return e.textContent}function P(e){return void 0===e}function R(e){return void 0!==e}A.primitive=function(e){return"string"==typeof e||"number"==typeof e},A.array=function(e){return Array.isArray(e)};var S=k("",{},[],void 0,void 0);function V(e,t){return e.key===t.key&&e.sel===t.sel}function F(e,t,r){var n,i,o,a={};for(n=t;n<=r;++n)null!=(o=e[n])&&void 0!==(i=o.key)&&(a[i]=n);return a}var H=["create","update","remove","destroy","pre","post"];function j(e,t){if(function(e){return 1===e.nodeType}(e)){var r,n=e.id?"#"+e.id:"",i=e.getAttribute("class"),o=i?"."+i.split(" ").join("."):"",a=O(e).toLowerCase()+n+o,d={},l=[],s=void 0,u=void 0,f=e.attributes,c=e.childNodes;for(s=0,u=f.length;s<u;s++)"id"!==(r=f[s].nodeName)&&"class"!==r&&(d[r]=f[s].nodeValue);for(s=0,u=c.length;s<u;s++)l.push(j(c[s]));return k(a,{attrs:d},l,void 0,e)}return function(e){return 3===e.nodeType}(e)?k(void 0,void 0,void 0,D(e),e):function(e){return 8===e.nodeType}(e)?k("!",{},[],D(e),e):k("",{},[],void 0,void 0)}var $=new DOMParser,q=function(e,t){var r,n,i={};for(r=0;r<H.length;++r)for(i[H[r]]=[],n=0;n<e.length;++n){var o=e[n][H[r]];void 0!==o&&i[H[r]].push(o)}function a(e){var t=e.id?"#"+e.id:"",r=e.className?"."+e.className.split(" ").join("."):"";return k(O(e).toLowerCase()+t+r,{},[],void 0,e)}function d(e,t){return function(){0==--t&&L(M(e),e)}}function l(e,t){var r,n=e.data;void 0!==n&&R(r=n.hook)&&R(r=r.init)&&(r(e),n=e.data);var o,a,d,s,u=e.children,f=e.sel;if("!"===f)P(e.text)&&(e.text=""),e.elm=(s=e.text,document.createComment(s));else if(void 0!==f){var c=f.indexOf("#"),v=f.indexOf(".",c),h=c>0?c:f.length,m=v>0?v:f.length,p=-1!==c||-1!==v?f.slice(0,Math.min(h,m)):f,y=e.elm=R(n)&&R(r=n.ns)?(a=r,d=p,document.createElementNS(a,d)):(o=p,document.createElement(o));for(h<m&&y.setAttribute("id",f.slice(h+1,m)),v>0&&y.setAttribute("class",f.slice(m+1).replace(/\./g," ")),r=0;r<i.create.length;++r)i.create[r](S,e);if(A.array(u))for(r=0;r<u.length;++r){var g=u[r];null!=g&&T(y,l(g,t))}else A.primitive(e.text)&&T(y,C(e.text));R(r=e.data.hook)&&(r.create&&r.create(S,e),r.insert&&t.push(e))}else e.elm=C(e.text);return e.elm}function s(e,t,r,n,i,o){for(;n<=i;++n){var a=r[n];null!=a&&N(e,l(a,o),t)}}function u(e){var t,r,n=e.data;if(void 0!==n){for(R(t=n.hook)&&R(t=t.destroy)&&t(e),t=0;t<i.destroy.length;++t)i.destroy[t](e);if(void 0!==e.children)for(r=0;r<e.children.length;++r)null!=(t=e.children[r])&&"string"!=typeof t&&u(t)}}function f(e,t,r,n){for(;r<=n;++r){var o=void 0,a=void 0,l=void 0,s=t[r];if(null!=s)if(R(s.sel)){for(u(s),a=i.remove.length+1,l=d(s.elm,a),o=0;o<i.remove.length;++o)i.remove[o](s,l);R(o=s.data)&&R(o=o.hook)&&R(o=o.remove)?o(s,l):l()}else L(e,s.elm)}}function c(e,t,r){var n,o;R(n=t.data)&&R(o=n.hook)&&R(n=o.prepatch)&&n(e,t);var a=t.elm=e.elm,d=e.children,u=t.children;if(e!==t){if(void 0!==t.data){for(n=0;n<i.update.length;++n)i.update[n](e,t);R(n=t.data.hook)&&R(n=n.update)&&n(e,t)}P(t.text)?R(d)&&R(u)?d!==u&&function(e,t,r,n){for(var i,o,a,d=0,u=0,v=t.length-1,h=t[0],m=t[v],p=r.length-1,y=r[0],g=r[p];d<=v&&u<=p;)null==h?h=t[++d]:null==m?m=t[--v]:null==y?y=r[++u]:null==g?g=r[--p]:V(h,y)?(c(h,y,n),h=t[++d],y=r[++u]):V(m,g)?(c(m,g,n),m=t[--v],g=r[--p]):V(h,g)?(c(h,g,n),N(e,h.elm,E(m.elm)),h=t[++d],g=r[--p]):V(m,y)?(c(m,y,n),N(e,m.elm,h.elm),m=t[--v],y=r[++u]):(void 0===i&&(i=F(t,d,v)),P(o=i[y.key])?(N(e,l(y,n),h.elm),y=r[++u]):((a=t[o]).sel!==y.sel?N(e,l(y,n),h.elm):(c(a,y,n),t[o]=void 0,N(e,a.elm,h.elm)),y=r[++u]));d>v?s(e,null==r[p+1]?null:r[p+1].elm,r,u,p,n):u>p&&f(e,t,d,v)}(a,d,u,r):R(u)?(R(e.text)&&B(a,""),s(a,null,u,0,u.length-1,r)):R(d)?f(a,d,0,d.length-1):R(e.text)&&B(a,""):e.text!==t.text&&B(a,t.text),R(o)&&R(n=o.postpatch)&&n(e,t)}}return function(e,t){var r,n,o,d=[];for(r=0;r<i.pre.length;++r)i.pre[r]();for(function(e){return void 0!==e.sel}(e)||(e=a(e)),V(e,t)?c(e,t,d):(o=M(n=e.elm),l(t,d),null!==o&&(N(o,t.elm,E(n)),f(o,[e],0,0))),r=0;r<d.length;++r)d[r].data.hook.insert(d[r]);for(r=0;r<i.post.length;++r)i.post[r]();return t}}([s,f,h,p,x]);_.isUndefined(Backbone.NativeView)?Backbone.View:Backbone.NativeView;function I(e){if("string"!=typeof e)throw new Error("Invalid parameter type in parseHTMLToDOM");if(!("DOMParser"in window))throw new Error("DOMParser is not available, so parsing string to DOM node is not possible.");if(!e)return document.createTextNode("");var t=($=$||new DOMParser).parseFromString(e,"text/html");return t.body?t.getElementsByTagName("body")[0]:t.head.firstChild&&("TITLE"!==t.head.firstChild.tagName||t.title)?t.head.firstChild:t.firstChild&&"HTML"!==t.firstChild.tagName?t.firstChild:document.createTextNode("")}Backbone.View.extend({updateEventListeners:function(e,t){this.setElement(t.elm)},render:function(e){var t;return _.isFunction(this.beforeRender)&&this.beforeRender(),(t=_.isNull(this.pkRender)?j(this.toDOM()):j(I(void 0===e?this.pkRender():this.pkRender(e)))).data.hook=_.extend({create:this.updateEventListeners.bind(this),update:this.updateEventListeners.bind(this)}),(this.vnode?this.vnode.elm:this.el).outerHTML!==t.elm.outerHTML&&(this.vnode=q(this.vnode||this.el,t)),_.isFunction(this.afterRender)&&this.afterRender(),this}})}();